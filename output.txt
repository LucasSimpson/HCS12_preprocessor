; ***************************************
; * Demo program by Lucas Simpson
; ***************************************

;  export symbols
            XDEF Entry, _Startup            ;  export 'Entry' symbol
            ABSENTRY Entry                  ;  for absolute assembly: mark this as application entry point
;  Include derivative-specific definitions 
            INCLUDE 'derivative.inc'        
ROMStart    EQU  $400                       ;  absolute address to place my code/constant data
;  code section
            ORG   ROMStart                  
Entry:                                      
_Startup:                                   
            LDAA #$01                       ;  set the LSb (b0), clear all others (b7-b1)
            STAA DDRJ                       ;  configure uC's Data Direction Register for Port J
; ***************************************
; * Code start
; ***************************************


;  Loop 5 times.
            LDAA #$05                       
            STAA $1501                      
loop_00     DECA                            
            STAA $1501                      
            LDAA #$01                       
            STAA PTJ                        ;  Turn on LED

;  Delay for 250 ms
            LDX  #5                         
delay_00    NOP                             
            LDY  #50000                     
delay_01    NOP                             
            NOP                             
            NOP                             
            NOP                             
            NOP                             
            DBNE Y, delay_01                
            DBNE X, delay_00                
            LDX  #1                         
delay_02    DBNE X, delay_03                
            NOP                             
            NOP                             
            NOP                             
            NOP                             
            JMP  delay_02                   
delay_03    NOP                             
;  End of delay.

            LDAA #$00                       
            STAA PTJ                        ;  Turn off LED

;  Delay for 250 ms
            LDX  #5                         
delay_04    NOP                             
            LDY  #50000                     
delay_05    NOP                             
            NOP                             
            NOP                             
            NOP                             
            NOP                             
            DBNE Y, delay_05                
            DBNE X, delay_04                
            LDX  #1                         
delay_06    DBNE X, delay_07                
            NOP                             
            NOP                             
            NOP                             
            NOP                             
            JMP  delay_06                   
delay_07    NOP                             
;  End of delay.

            LDAA $1501                      
            BGT  loop_00                    
;  Loop end.

; ***************************************
; * Interrupt Vectors
; ***************************************

            ORG   $FFFE                     
            DC.W  Entry                     ;  Reset Vector

